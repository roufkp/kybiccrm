{% extends "main.html" %}
{% load static %}



{% block content %}


    <div class="sub-container-1 " >
        <h1 ></h1>

       
        <!-- # Total Count Session -->

        <div class="total-count pt-10   mb-3 pl-auto md:pl-10">
            <p class="font-bold text-gray-400 pl-10 md:sm-0" id="dateRangeText" style="width: 100%;"> <strong class="uppercase text-gray-600" >From {{start_date_str}}- To {{end_date_str}}</strong> </p>

            <div class="flex justify-between rounded-xl shadow-md p-2" style="    width: auto;position: absolute;background-color: #c6ddeb;right: 10px;top: 50px;">
                <div class="flex justify-between flex-col" style="width: auto; background-color: transparent;">
                    
                    <button class="text-sm font-bold text-gray-500 " id="showFormButton" style="width: auto;text-align: end;">Select Date Range</button>
                    <div id="formContainer" class="px-5 py-0 rounded-xl mb-0" style="display: none; background-color: transparent; flex-direction: row; align-items: center;">
                      
                     
                      <hr>
                      <form method="get" action="." class="font-medium text-s flex flex-col flex-wrap items-start mt-5">
                        <div class="mb-3">
                          <label for="start_date">Start:</label>
                          <input type="date" id="start_date" name="start_date" value="{{ start_date_str }}">
                        </div>
                        <div class="mb-3">
                          <label for="end_date">End:</label>
                          <input type="date" id="end_date" name="end_date" value="{{ end_date_str }}">
                        </div>  
                        <button type="submit" class="button">Apply</button>
                      </form>
                    </div>
                    <!-- Add a button or text element to trigger the form visibility -->
                    
                    <!-- Alternatively, use a text element instead of a button -->
                    <!-- <p id="showFormButton" class="text-blue-600 cursor-pointer">Show Form</p> -->
                  </div>
                  
                 <!-- <img src="{% static 'images/dashboardbg.png' %}" alt="" class="w-60" > -->
            </div>
            <div class="one ">
                <div class="text">
                    <p>Total</p>
                    <h4>Campaigns</h4>
                <h2>{{total_campaign_count}}</h2>
                <p>
                    <a href="{% url 'campaign:campaign-list' %}" class="flex flex-row items-center flex-wrap">
                        View More <i class="bx bx-chevrons-right " style="margin-bottom:-2px"></i>
                    </a>
                </p>
                </div>
            </div>
            <div class="one">
                <div class="text">
                    <h4>Total Leads</h4>
                <h2>{{total_lead_count_date}}</h2>
                <p>
                    <a href="{% url 'leads:category-list' %}" class="flex flex-row items-center flex-wrap">
                        View More <i class="bx bx-chevrons-right " style="margin-bottom:-2px"></i>
                    </a>
                </p>
                </div>
            </div>
            <div class="one">
                <div class="text">
                    <p>Leads to</p>
                    <h4>Follow Up</h4>
                <h2>{{followup_in_date_range}}</h2>                
                <p>
                    <a href="{% url 'leads:followup-list' %}" class="flex flex-row items-center flex-wrap">
                        View More <i class="bx bx-chevrons-right " style="margin-bottom:-2px"></i>
                    </a>
                </p>
                </div>
            </div>
            <div class="one">
                <div class="text">
                    <p>Total</p>
                    <h4>Converted</h4>
                <h2>{{leads_converted_in_date_range}}</h2>
                <p>
                    <a href="{% url 'leads:category-list' %}" class="flex flex-row items-center flex-wrap">
                        View More <i class="bx bx-chevrons-right " style="margin-bottom:-2px"></i>
                    </a>
                </p>
                </div>
                
            </div>
            
            
        </div>
        <!-- <img src="{% static 'images/dashboardbg.png' %}" alt="" class="w-60"> -->
        <div class="total-leads flex flex-row items-baseline pl-auto md:pl-10" style="height:auto;overflow:scroll">
            <!-- # chart -->
            {% include "chart.html" %}
            <div class=" px-5 py-5 rounded  mx-auto date-result">
                <h1 class="text-lg font-bold text-gray-500 ">Your Results</h1><hr style="width:100%">
                
                <div>
                  <p >Total <br> Leads</p>
                  <span >{{total_lead_count_date}}</span>
                </div>
                <div>
                  <p >New <br> Leads</p>
                  <span >{{new_lead_count_date}}</span>
                </div>
                <div>
                  <p >Follow up <br> Leads</p>
                  <span >{{followup_in_date_range}}</span>
                </div>
                <div>
                  <p >Converted <br> Leads</p>
                  <span >{{leads_converted_in_date_range}}</span>
                </div>
                <div>
                  <p >Rejected <br> Leads</p>
                  <span >{{rejected_in_date_range}}</span>
                </div>
              </div> 
        </div>
 

        <!-- # New Lead Session -->

  <!-- <h1 class="text-1xl font-bold  ml-5">Campaigns</h1> -->
    <div class="total-count-2 pt-5 border border-b-indigo-100 pl-auto md:pl-10">
        <div class="" style="width:100%">
            <p class="font-bold text-gray-400 pl-10"><strong class="uppercase text-gray-600">{{user.username}}</strong> , These are the Campaigns.</p>
        </div>
        
        {% for campaign in campaigns %}
        <div class="one">
            <div class="text">
                <h5>Campaign</h5>
                <h4 class="uppercase">{{ campaign.name }}</h4>
                {% comment %} <h5>Total Leads:{{ campaign.lead_count }}</h5> {% endcomment %}
                <p>
                    <a href="{% url 'campaigns:campaign-detail' campaign.pk %}" class="flex flex-row items-center flex-wrap">
                        View More <i class="bx bx-chevrons-right " style="margin-bottom:-2px"></i>
                    </a>
                </p>
            </div>
        </div>
        {% empty %}
        No campaigns found.
        {% endfor %}
    </div>

  

       
    </div>
</div>
<script>
    // Function to update the "Last 30 days" text with the selected date range
    function updateDateRangeText(startDate, endDate) {
      const dateRangeText = document.getElementById('dateRangeText');
      dateRangeText.innerHTML = ` <strong class="uppercase text-gray-600">From ${startDate} - To ${endDate}</strong>`;
    }
  
    // Function to handle form submission
    function handleSubmit(event) {
    //   event.preventDefault(); // Prevent the form from submitting normally (we'll handle it with JavaScript)
  
      // Get the selected start and end dates from the form
      const startDate = document.getElementById('start_date').value;
      const endDate = document.getElementById('end_date').value;
  
      // Update the "Last 30 days" text with the selected date range
      updateDateRangeText(startDate, endDate);
  
      // Optionally, you can perform additional actions here, like submitting the form data to the server via AJAX
    }
  
    // Get references to the form and add a submit event listener
    const form = document.querySelector('form');
    form.addEventListener('submit', handleSubmit);
  </script>
  
<script>
    // Get references to the form container and the button (or text)
    const formContainer = document.getElementById('formContainer');
    const showFormButton = document.getElementById('showFormButton');
  
    // Function to toggle the visibility of the form container
    function toggleFormVisibility() {
      if (formContainer.style.display === 'none') {
        formContainer.style.display = 'flex';
      } else {
        formContainer.style.display = 'none';
      }
    }
  
    // Add a click event listener to the button (or text) to trigger the visibility toggle
    showFormButton.addEventListener('click', toggleFormVisibility);
  </script>
  

<!-- JS File -->
<script type="text/javascript" src={% static 'js/main.js' %}>
</script>


  
{% endblock content %}




    
  
   